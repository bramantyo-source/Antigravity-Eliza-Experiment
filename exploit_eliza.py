import time
import sys
import eliza_advanced

def run_exploit():
    print("="*50)
    print("ELIZA EXPLOIT: STRESS TEST & DOS SIMULATION")
    print("="*50)

    # Payload 1: Normal Input
    print("\n[TEST 1] Normal Input (Halo)")
    start = time.time()
    eliza_advanced.analyze("Halo")
    end = time.time()
    print(f"Response Time: {end - start:.6f} seconds")

    # Payload 2: Massive Input (1 Juta Karakter)
    # Ini mensimulasikan serangan DoS memori/CPU
    print("\n[TEST 2] Massive Input Attack (1.000.000 'a')")
    payload = "a" * 1000000 + " takut" # Menambahkan trigger word di akhir
    
    print(f"Sending payload size: {len(payload)} bytes...")
    start = time.time()
    try:
        eliza_advanced.analyze(payload)
        end = time.time()
        print(f"Response Time: {end - start:.6f} seconds")
        print("STATUS: SURVIVED (But check lag)")
    except Exception as e:
        print(f"STATUS: CRASHED! Error: {e}")

    # Payload 3: ReDoS Attempt (Nested patterns)
    # Mencoba memicu backtracking regex yang buruk
    print("\n[TEST 3] ReDoS Attempt (Complex Pattern)")
    # Pola berulang yang membingungkan regex (.*) (.*) (.*)
    payload_redos = "aku merasa " + ("sangat " * 5000) + "sedih"
    
    print(f"Sending ReDoS payload...")
    start = time.time()
    try:
        eliza_advanced.analyze(payload_redos)
        end = time.time()
        print(f"Response Time: {end - start:.6f} seconds")
    except Exception as e:
        print(f"STATUS: CRASHED! Error: {e}")

if __name__ == "__main__":
    run_exploit()
